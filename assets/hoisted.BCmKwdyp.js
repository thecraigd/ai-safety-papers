import"./hoisted.CvQEWfIr.js";const be=document.getElementById("papers-data"),ke=document.getElementById("categories-data"),xe=document.getElementById("all-papers-url"),ye=document.getElementById("conference-papers-url"),Le=document.getElementById("approved-tags-data"),Ge=xe?JSON.parse(xe.textContent||'""'):"",Ke=ye?JSON.parse(ye.textContent||'""'):"",Qe=Le?JSON.parse(Le.textContent||"{}"):{};let b=be?JSON.parse(be.textContent||"[]"):[];const Xe=ke?JSON.parse(ke.textContent||"{}"):{};let we=!1,se=!1;function d(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Ee(){const e=document.querySelector(".filter-scroll-container"),s=e?.querySelector(".filter-scroll-area"),t=e?.querySelector(".scroll-arrow-left"),a=e?.querySelector(".scroll-arrow-right");if(!e||!s||!t||!a)return;const o=200;function n(){const{scrollLeft:m,scrollWidth:F,clientWidth:te}=s,w=m>1,C=m<F-te-1;t.classList.toggle("hidden",!w),a.classList.toggle("hidden",!C),e.classList.toggle("show-left",w),e.classList.toggle("show-right",C)}t.addEventListener("click",()=>{s.scrollBy({left:-o,behavior:"smooth"})}),a.addEventListener("click",()=>{s.scrollBy({left:o,behavior:"smooth"})}),s.addEventListener("scroll",n),new ResizeObserver(()=>{n()}).observe(s),n()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ee):Ee();let v=[...b],q=0;const Oe=30;let E="",i=new Set,c="all",l=new Set,f="all",je="date-desc",ae=!1,g=null,_=!1;const ee=new URLSearchParams(window.location.search),re=ee.get("tag");re&&l.add(re);const le=ee.get("score");if(le){const e=parseInt(le);[5,6,7,8,9].includes(e)&&(g=e)}const Q=ee.get("venue");Q&&(c=Q);const z=ee.get("date");z&&["1","7","14","30","latest"].includes(z)&&(f=z);(re||le||Q&&Q!=="all"||z&&z!=="all")&&(_=!0);const k=document.getElementById("search-input"),ie=document.getElementById("clear-search"),H=document.getElementById("search-query"),Se=document.getElementById("visible-count"),Ce=document.getElementById("total-matching"),V=document.getElementById("clear-all-filters"),Te=document.getElementById("no-results"),N=document.getElementById("end-of-results"),M=document.getElementById("papers-container"),R=document.getElementById("loading-indicator"),$e=document.getElementById("scroll-sentinel"),ce=document.querySelectorAll(".filter-btn"),X=document.querySelectorAll(".date-filter-btn"),ze=document.getElementById("sort-toggle"),x=document.getElementById("sort-dropdown"),Be=document.getElementById("sort-label"),Ae=document.querySelectorAll(".sort-option"),Z=document.getElementById("venue-toggle"),y=document.getElementById("venue-dropdown"),U=document.getElementById("venue-label"),Ie=document.getElementById("conference-venues"),P=document.getElementById("tags-toggle"),S=document.getElementById("tags-dropdown"),ne=document.getElementById("tags-label"),J=document.getElementById("tags-count"),u=document.getElementById("tags-list"),B=document.getElementById("tags-search"),De=document.getElementById("clear-tags"),W=document.getElementById("advanced-filters-section"),Me=document.getElementById("advanced-filters-toggle"),oe=document.getElementById("advanced-filters-toggle-container"),Y=document.getElementById("advanced-toggle-icon"),G=document.getElementById("advanced-toggle-text"),de=document.querySelectorAll(".score-filter-btn"),Ze={"date-desc":"Newest","date-asc":"Oldest","editor-score":"Editor Score",author:"Author",title:"Title"};let K=null,qe=0;function Ve(){if(qe!==b.length&&(K=null,qe=b.length),K)return K;if(b.length===0)return null;let e=null;for(const s of b){const t=new Date(s.published);t.setHours(0,0,0,0),(!e||t>e)&&(e=t)}return K=e,e}const Fe="guardrail_bookmarks";function He(){try{const e=localStorage.getItem(Fe);return e?JSON.parse(e):[]}catch{return[]}}function et(e){localStorage.setItem(Fe,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("bookmarksUpdated",{detail:{bookmarks:e}}))}function tt(e,s){const a=He().includes(e.id),o=e.authors||[],n=e.abstract||"",r=e.summary||"",m=new Date(e.published),te=new Date().getTime()-m.getTime(),w=Math.floor(te/(1e3*60*60*24));let C="";w===0?C="Today":w===1?C="Yesterday":w<7?C=`${w} days ago`:w<30?C=`${Math.floor(w/7)} weeks ago`:C=`${Math.floor(w/30)} months ago`;const Je=o.length>3?`${o.slice(0,3).join(", ")} +${o.length-3} more`:o.join(", "),j=e.editor_score?.weighted_score!=null,ge=j?e.editor_score.weighted_score:0,me=ge.toFixed(1),We=j?Math.round(ge/10*5):0,Ye=(e.categories||[]).map(T=>{const D=Xe[T]||{name:T,gradient:"from-slate-500 to-slate-600"};return`<span class="inline-flex items-center px-2.5 py-1 rounded-lg text-[11px] font-semibold text-white bg-gradient-to-r ${D.gradient} shadow-sm">${d(D.name)}</span>`}).join(""),he=(e.tags||[]).map(T=>{const D=T.split("-").map(ve=>ve.charAt(0).toUpperCase()+ve.slice(1)).join(" ");return`<button type="button" class="tag-link text-xs text-slate-500 dark:text-slate-400 hover:text-brass-600 dark:hover:text-brass-400 hover:underline transition-colors cursor-pointer" data-tag="${d(T)}">${d(D)}</button>`}).join('<span class="text-slate-400 dark:text-slate-500 text-xs">, </span>');let pe="";if(e.conference){const T=e.conference.workshop?`${e.conference.name} ${e.conference.year} Workshop`:`${e.conference.name} ${e.conference.year}`,D=e.conference.workshop||e.conference.track;pe=`
        <div class="flex flex-wrap gap-2 mb-4">
          <span class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-semibold bg-gradient-to-r from-purple-500 to-indigo-600 text-white shadow-sm">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
            </svg>
            ${d(T)}
          </span>
          <span class="inline-flex items-center px-3 py-1.5 rounded-lg text-xs font-medium bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 border border-slate-200/60 dark:border-slate-700/60">
            ${d(D||"")}
          </span>
        </div>
      `}return`
      <div class="paper-item" style="animation-delay: ${s%Oe*30}ms" data-paper-id="${d(e.id)}">
        <article class="group relative bg-white/90 dark:bg-slate-900/80 backdrop-blur-sm rounded-2xl border border-slate-200/70 dark:border-slate-800/60 shadow-[0_20px_50px_-40px_rgba(31,27,23,0.35)] hover:shadow-[0_25px_60px_-40px_rgba(31,27,23,0.45)] transition-all duration-300 overflow-hidden hover-lift">
          <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-brass-400 via-brass-500 to-brass-400 opacity-0 group-hover:opacity-100 transition-opacity"></div>

          <div class="p-6">
            <!-- Header with date and relevance -->
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-3">
                <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-medium bg-slate-100/80 dark:bg-slate-800/80 text-slate-600 dark:text-slate-400 border border-slate-200/50 dark:border-slate-700/50">
                  <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                  </svg>
                  ${C}
                </span>
                <span class="text-xs text-slate-400 dark:text-slate-500">${m.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}</span>
              </div>
              <div class="flex flex-col items-end gap-0.5" title="${j?`Editor Score: ${me}/10`:"Not yet scored"}">
                <span class="text-sm font-semibold text-slate-600 dark:text-slate-400">${j?me:"--"}</span>
                <div class="flex items-center gap-1">
                  ${[1,2,3,4,5].map(T=>`<div class="w-1 h-3 rounded-full ${j&&T<=We?"bg-gradient-to-t from-brass-500 to-brass-400":"bg-slate-200 dark:bg-slate-700"}"></div>`).join("")}
                </div>
              </div>
            </div>

            ${pe}

            <!-- Title -->
            <h2 class="text-lg font-display font-semibold tracking-tight text-slate-900 dark:text-white mb-3 leading-snug group-hover:text-brass-700 dark:group-hover:text-brass-400 transition-colors">
              <a href="${d(e.arxiv_url)}" target="_blank" rel="noopener noreferrer" class="hover:underline decoration-2 underline-offset-2" data-paper-title="${d(e.title.toLowerCase())}">
                ${d(e.title)}
              </a>
            </h2>

            <!-- Authors -->
            <p class="text-sm text-slate-500 dark:text-slate-400 mb-4" data-paper-authors="${d(o.join(" ").toLowerCase())}">
              ${d(Je)}
            </p>

            <!-- Summary -->
            <p class="text-slate-700 dark:text-slate-300 leading-relaxed mb-5 text-[15px]" data-paper-summary="${d(r.toLowerCase())}">
              ${d(r)}
            </p>

            <!-- Categories -->
            <div class="flex flex-wrap gap-2 mb-3">
              ${Ye}
            </div>

            <!-- Tags -->
            ${he?`<div class="mb-5 leading-relaxed">${he}</div>`:""}

            <!-- Action buttons -->
            <div class="flex items-center gap-2 pt-4 border-t border-slate-100 dark:border-slate-800">
              <a href="${d(e.arxiv_url)}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-white bg-slate-900 hover:bg-slate-800 shadow-sm hover:shadow-md transition-all ring-1 ring-brass-400/40 dark:bg-slate-100 dark:text-slate-900 dark:hover:bg-white dark:ring-brass-300/40">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                </svg>
                View Paper
              </a>
              <a href="${d(e.pdf_url)}" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100/80 dark:bg-slate-800/80 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors border border-slate-200/60 dark:border-slate-700/60">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
                PDF
              </a>
              <button class="bookmark-btn inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-300 bg-slate-100/80 dark:bg-slate-800/80 hover:bg-brass-100 dark:hover:bg-brass-900/30 transition-all border border-slate-200/60 dark:border-slate-700/60 hover:border-brass-300 dark:hover:border-brass-700 ${a?"bookmarked":""}" data-paper-id="${d(e.id)}">
                <svg class="w-4 h-4 bookmark-icon" fill="${a?"currentColor":"none"}" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
                </svg>
                <span class="bookmark-text">${a?"Saved":"Save"}</span>
              </button>
            </div>

            <!-- Hidden abstract for search -->
            <div class="hidden" data-paper-abstract="${d(n.toLowerCase())}"></div>
          </div>
        </article>
      </div>
    `}function p(){const e=E.toLowerCase().trim();v=b.filter(s=>{if(e&&!(s.title.toLowerCase().includes(e)||(s.abstract||"").toLowerCase().includes(e)||(s.summary||"").toLowerCase().includes(e)||(s.authors||[]).some(a=>a.toLowerCase().includes(e))))return!1;if(c!=="all"){if(c==="arxiv"){if(s.conference)return!1}else if(!s.conference||`${s.conference.name} ${s.conference.year}`!==c)return!1}if(i.size>0&&!i.has("all")&&!s.categories.some(a=>i.has(a)))return!1;if(l.size>0){const t=s.tags||[];for(const a of l)if(!t.includes(a))return!1}if(g!==null){const t=s.editor_score?.weighted_score;if(t===void 0||t<g)return!1}if(f!=="all")if(f==="latest"){const t=Ve();if(t){const a=new Date(s.published);if(a.setHours(0,0,0,0),a.getTime()!==t.getTime())return!1}}else{const t=parseInt(f),a=new Date,o=new Date(a.getTime()-t*24*60*60*1e3);if(o.setHours(0,0,0,0),new Date(s.published)<o)return!1}return!0}),v.sort((s,t)=>{switch(je){case"date-desc":return new Date(t.published).getTime()-new Date(s.published).getTime();case"date-asc":return new Date(s.published).getTime()-new Date(t.published).getTime();case"editor-score":const a=s.editor_score?.weighted_score??-1;return(t.editor_score?.weighted_score??-1)-a;case"author":return(s.authors[0]||"").localeCompare(t.authors[0]||"");case"title":return s.title.localeCompare(t.title);default:return 0}})}function _e(){const e=E.toLowerCase().trim(),s=b.filter(a=>{if(e&&!(a.title.toLowerCase().includes(e)||(a.abstract||"").toLowerCase().includes(e)||(a.summary||"").toLowerCase().includes(e)||(a.authors||[]).some(n=>n.toLowerCase().includes(e))))return!1;if(c!=="all"){if(c==="arxiv"){if(a.conference)return!1}else if(!a.conference||`${a.conference.name} ${a.conference.year}`!==c)return!1}if(i.size>0&&!i.has("all")&&!a.categories.some(n=>i.has(n)))return!1;if(g!==null){const o=a.editor_score?.weighted_score;if(o===void 0||o<g)return!1}if(f!=="all")if(f==="latest"){const o=Ve();if(o){const n=new Date(a.published);if(n.setHours(0,0,0,0),n.getTime()!==o.getTime())return!1}}else{const o=parseInt(f),n=new Date,r=new Date(n.getTime()-o*24*60*60*1e3);if(r.setHours(0,0,0,0),new Date(a.published)<r)return!1}return!0}),t=new Set;for(const a of s){const o=a.tags||[];let n=!0;for(const r of l)if(!o.includes(r)){n=!1;break}if(n)for(const r of o)t.add(r)}return t}function Pe(e){if(!u)return;const s=u.querySelectorAll(".tag-option"),t=[],a=[];s.forEach(n=>{const r=n.dataset.tag;if(!r)return;const m=n.querySelector(".tag-checkbox"),F=l.has(r);e.has(r)?(n.classList.remove("tag-disabled"),n.removeAttribute("title"),m&&(m.disabled=!1),t.push(n)):(n.classList.add("tag-disabled"),n.setAttribute("title","No papers match with current filters"),m&&!F&&(m.disabled=!0),a.push(n))});const o=u.querySelector(".tag-separator");if(o&&o.remove(),t.forEach(n=>u.appendChild(n)),t.length>0&&a.length>0){const n=document.createElement("div");n.className="tag-separator",u.appendChild(n)}a.forEach(n=>u.appendChild(n))}function st(e){const s=document.querySelector(".tag-removed-toast");s&&s.remove();const t=document.createElement("div");t.className="tag-removed-toast",t.textContent=`Removed "${e}" - no matching papers`,document.body.appendChild(t),setTimeout(()=>{t.classList.add("fade-out"),setTimeout(()=>t.remove(),300)},3e3)}function at(e){const s=[];for(const t of l)e.has(t)||s.push(t);for(const t of s){l.delete(t);const a=u?.querySelector(`.tag-checkbox[data-tag="${t}"]`);a&&(a.checked=!1);const o=t.split("-").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ");st(o)}s.length>0&&O()}function L(e=!1){const s=_e();if(e){at(s);const t=_e();Pe(t)}else Pe(s)}function h(e=!1){if(!M)return;e&&(M.innerHTML="",q=0);const s=q,t=Math.min(s+Oe,v.length);if(s>=v.length){N&&N.classList.toggle("hidden",v.length===0);return}const a=document.createDocumentFragment(),o=document.createElement("div");for(let n=s;n<t;n++){o.innerHTML=tt(v[n],n);const r=o.firstElementChild;r&&a.appendChild(r)}M.appendChild(a),q=t,ot(),nt(),N&&N.classList.toggle("hidden",q<v.length||v.length===0)}function nt(){if(Se&&(Se.textContent=String(q)),Ce&&(Ce.textContent=String(v.length)),Te&&M&&(Te.classList.toggle("hidden",v.length>0),M.classList.toggle("hidden",v.length===0)),H&&(E?(H.textContent=`for "${E}"`,H.classList.remove("hidden")):H.classList.add("hidden")),ie&&ie.classList.toggle("hidden",!E),V){const e=E||i.size>0&&!i.has("all");V.classList.toggle("hidden",!e)}}function ot(){document.querySelectorAll(".bookmark-btn:not([data-initialized])").forEach(e=>{const s=e;s.dataset.initialized="true",s.addEventListener("click",()=>{const t=s.dataset.paperId;if(!t)return;let a=He();const o=s.querySelector(".bookmark-icon"),n=s.querySelector(".bookmark-text");a.includes(t)?(a=a.filter(r=>r!==t),s.classList.remove("bookmarked"),o&&o.setAttribute("fill","none"),n&&(n.textContent="Save")):(a.push(t),s.classList.add("bookmarked"),o&&o.setAttribute("fill","currentColor"),n&&(n.textContent="Saved")),et(a)})})}function rt(e,s){let t;return(...a)=>{clearTimeout(t),t=setTimeout(()=>e(...a),s)}}const lt=rt(()=>{E=k?.value||"",p(),h(!0),L(!0),$(),I()},200),it=new IntersectionObserver(e=>{e.forEach(s=>{s.isIntersecting&&!ae&&q<v.length&&(ae=!0,R&&R.classList.remove("hidden"),setTimeout(()=>{h(!1),ae=!1,R&&R.classList.add("hidden")},150))})},{rootMargin:"200px"});$e&&it.observe($e);k?.addEventListener("input",lt);ie?.addEventListener("click",()=>{k&&(k.value="",E="",p(),h(!0),k.focus())});ce.forEach(e=>{e.addEventListener("click",()=>{const s=e.getAttribute("data-category");s&&(s==="all"?(i.clear(),ce.forEach(t=>t.classList.remove("active")),e.classList.add("active")):(i.delete("all"),document.querySelector('[data-category="all"]')?.classList.remove("active"),i.has(s)?(i.delete(s),e.classList.remove("active")):(i.add(s),e.classList.add("active")),i.size===0&&document.querySelector('[data-category="all"]')?.classList.add("active")),p(),h(!0),L(!0),$(),I())})});X.forEach(e=>{e.addEventListener("click",()=>{const s=e.getAttribute("data-date-range");s&&(f=s,X.forEach(t=>t.classList.remove("active")),e.classList.add("active"),p(),h(!0),L(!0),$(),A(),I())})});V?.addEventListener("click",()=>{E="",k&&(k.value=""),i.clear(),ce.forEach(e=>e.classList.remove("active")),document.querySelector('[data-category="all"]')?.classList.add("active"),c="all",ue(),fe(),l.clear(),O(),u&&u.querySelectorAll(".tag-checkbox").forEach(e=>{e.checked=!1}),B&&(B.value=""),Ue(),f="all",X.forEach(e=>e.classList.remove("active")),document.querySelector('[data-date-range="all"]')?.classList.add("active"),g=null,de.forEach(e=>e.classList.remove("active")),p(),h(!0),L(!1),$(),A(),I()});document.addEventListener("keydown",e=>{e.key==="/"&&document.activeElement!==k&&(e.preventDefault(),k?.focus()),e.key==="Escape"&&(document.activeElement===k&&k?.blur(),x?.classList.add("hidden"),y?.classList.add("hidden"),S?.classList.add("hidden"))});ze?.addEventListener("click",e=>{e.stopPropagation(),x?.classList.toggle("hidden"),y?.classList.add("hidden"),S?.classList.add("hidden")});document.addEventListener("click",e=>{if(x&&!x.classList.contains("hidden")){const s=e.target;!ze?.contains(s)&&!x.contains(s)&&x.classList.add("hidden")}});Ae.forEach(e=>{e.addEventListener("click",()=>{const s=e.dataset.sort;s&&(je=s,Be&&(Be.textContent=Ze[s]||"Sort"),Ae.forEach(t=>{const a=t.querySelector(".sort-check"),o=t.dataset.sort===s;a?.classList.toggle("hidden",!o),t.classList.toggle("text-slate-900",o),t.classList.toggle("dark:text-white",o),t.classList.toggle("text-slate-700",!o),t.classList.toggle("dark:text-slate-300",!o)}),p(),h(!0),x?.classList.add("hidden"))})});p();h(!0);async function ct(){if(!(we||se)){se=!0;try{const[e,s]=await Promise.all([fetch(Ge,{cache:"no-store"}),fetch(Ke,{cache:"no-store"}).catch(()=>null)]);let t=[];if(e.ok){const a=await e.json();t=Array.isArray(a?.papers)?a.papers:[]}if(s?.ok){const a=await s.json(),o=Array.isArray(a?.papers)?a.papers:[],n=new Set(t.map(r=>r.id));for(const r of o)n.has(r.id)||t.push(r)}t.length>b.length&&(b=t,dt(),Re(),p(),h(!0),L(!1)),we=!0}catch(e){console.warn("Unable to load full paper database from R2:",e)}finally{se=!1}}}function dt(){if(!Ie)return;const e=new Map;for(const t of b)if(t.conference){const a=`${t.conference.name} ${t.conference.year}`;e.set(a,(e.get(a)||0)+1)}const s=Array.from(e.entries()).sort((t,a)=>{const[o]=t,[n]=a,r=parseInt(o.split(" ").pop()||"0"),m=parseInt(n.split(" ").pop()||"0");return r!==m?m-r:o.localeCompare(n)});Ie.innerHTML=s.map(([t,a])=>`
      <button class="venue-option w-full px-4 py-2 text-left text-sm font-medium text-slate-700 dark:text-slate-300 hover:bg-brass-50 dark:hover:bg-brass-900/20 transition-colors flex items-center justify-between" data-venue="${t}">
        <span>${t}</span>
        <div class="flex items-center gap-2">
          <span class="text-xs text-slate-400">(${a})</span>
          <svg class="w-4 h-4 text-brass-500 venue-check hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </div>
      </button>
    `).join(""),Ne()}function Ne(){document.querySelectorAll(".venue-option").forEach(s=>{s.addEventListener("click",()=>{const t=s.dataset.venue;t&&(c=t,ue(),fe(),p(),h(!0),L(!0),y&&y.classList.add("hidden"),$(),A(),I())})})}function ue(){U&&(c==="all"?U.textContent="All Papers":c==="arxiv"?U.textContent="arXiv Preprints":U.textContent=c)}function fe(){document.querySelectorAll(".venue-option").forEach(s=>{const t=s.dataset.venue,a=s.querySelector(".venue-check");a&&a.classList.toggle("hidden",t!==c)})}function Re(){if(!u)return;const e=new Set;for(const t of b)for(const a of t.tags||[])e.add(a);const s=Object.entries(Qe).filter(([t])=>e.has(t)).sort((t,a)=>t[0].localeCompare(a[0]));u.innerHTML=s.map(([t,a])=>{const o=t.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),n=l.has(t);return`
        <label class="tag-option flex items-center gap-3 px-4 py-2 hover:bg-slate-50 dark:hover:bg-slate-800/50 cursor-pointer transition-colors" data-tag="${t}">
          <input type="checkbox" class="tag-checkbox w-4 h-4 rounded border-slate-300 dark:border-slate-600 text-brass-500 focus:ring-brass-500/50" data-tag="${t}" ${n?"checked":""} />
          <span class="text-sm font-medium text-slate-700 dark:text-slate-300">${o}</span>
        </label>
      `}).join(""),l.size>0&&O(),u.querySelectorAll(".tag-checkbox").forEach(t=>{t.addEventListener("change",a=>{const o=a.target,n=o.dataset.tag;n&&(o.checked?l.add(n):l.delete(n),O(),p(),h(!0),L(!1),$(),A(),I())})})}function O(){!ne||!J||(l.size===0?(ne.textContent="All Tags",J.classList.add("hidden")):(ne.textContent=`${l.size} tag${l.size>1?"s":""}`,J.textContent=String(l.size),J.classList.remove("hidden")))}function Ue(){if(!u||!B)return;const e=B.value.toLowerCase().trim();u.querySelectorAll(".tag-option").forEach(t=>{const a=t.dataset.tag||"",o=a.split("-").join(" ").toLowerCase(),n=!e||o.includes(e)||a.includes(e);t.style.display=n?"":"none"})}function $(){const e=E||i.size>0&&!i.has("all")||c!=="all"||l.size>0||f!=="all"||g!==null;V&&V.classList.toggle("hidden",!e)}function ut(){return c!=="all"||l.size>0||f!=="all"||g!==null}function A(){if(!W||!Me||!oe)return;ut()?(W.classList.remove("hidden"),oe.classList.add("hidden"),_=!0):(oe.classList.remove("hidden"),_?(W.classList.remove("hidden"),Y&&Y.classList.add("rotate-180"),G&&(G.textContent="Hide Advanced Filters")):(W.classList.add("hidden"),Y&&Y.classList.remove("rotate-180"),G&&(G.textContent="Show Advanced Filters")))}function I(){const e=new URLSearchParams;i.size>0&&!i.has("all")&&e.set("categories",Array.from(i).join(",")),l.size>0&&e.set("tag",Array.from(l)[0]),c!=="all"&&e.set("venue",c),f!=="all"&&e.set("date",f),g!==null&&e.set("score",String(g));const s=e.toString()?`${window.location.pathname}?${e.toString()}`:window.location.pathname;window.history.replaceState({},"",s)}Me?.addEventListener("click",()=>{_=!_,A()});de.forEach(e=>{e.addEventListener("click",()=>{const s=parseInt(e.dataset.score||"0");g===s?(g=null,e.classList.remove("active")):(g=s,de.forEach(t=>t.classList.remove("active")),e.classList.add("active")),p(),h(!0),L(!0),A(),$(),I()})});Z&&y&&Z.addEventListener("click",e=>{e.stopPropagation(),y.classList.toggle("hidden"),S&&S.classList.add("hidden"),x&&x.classList.add("hidden")});P&&S&&P.addEventListener("click",e=>{e.stopPropagation(),S.classList.toggle("hidden"),y&&y.classList.add("hidden"),x&&x.classList.add("hidden"),!S.classList.contains("hidden")&&B&&setTimeout(()=>B.focus(),50)});B&&B.addEventListener("input",Ue);De&&De.addEventListener("click",()=>{l.clear(),O(),u&&u.querySelectorAll(".tag-checkbox").forEach(e=>{e.checked=!1}),p(),h(!0),L(!1),$()});document.addEventListener("click",e=>{const s=e.target;y&&Z&&!y.contains(s)&&!Z.contains(s)&&y.classList.add("hidden"),S&&P&&!S.contains(s)&&!P.contains(s)&&S.classList.add("hidden")});Ne();Re();L(!1);function ft(e){const s=document.querySelector(".tag-filter-toast");s&&s.remove();const t=e.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" "),a=l.size-1,o=a>0?`Filtering by: ${t} (+${a} more)`:`Filtering by: ${t}`,n=document.createElement("div");n.className="tag-filter-toast",n.innerHTML=`
      <span>${o}</span>
      <button class="tag-filter-toast-link">View filters</button>
    `,document.body.appendChild(n),n.querySelector(".tag-filter-toast-link")?.addEventListener("click",()=>{const r=document.querySelector(".sticky.top-14");r&&(r.scrollIntoView({behavior:"smooth",block:"start"}),P?.classList.add("ring-2","ring-brass-500"),setTimeout(()=>{P?.classList.remove("ring-2","ring-brass-500")},2e3)),n.remove()}),setTimeout(()=>{n.classList.add("fade-out"),setTimeout(()=>n.remove(),300)},4e3)}document.addEventListener("click",e=>{const s=e.target;if(s.classList.contains("tag-link")){e.preventDefault();const t=s.dataset.tag;if(!t)return;if(!l.has(t)){l.add(t);const a=u?.querySelector(`.tag-checkbox[data-tag="${t}"]`);a&&(a.checked=!0),O(),_=!0,A(),ft(t),p(),h(!0),L(!1),$(),I()}}});A();g!==null&&document.querySelector(`.score-filter-btn[data-score="${g}"]`)?.classList.add("active");c!=="all"&&(ue(),fe());f!=="all"&&(X.forEach(e=>e.classList.remove("active")),document.querySelector(`[data-date-range="${f}"]`)?.classList.add("active"));ct();
